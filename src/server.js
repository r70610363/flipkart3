import express from \'express\';\nimport cors from \'cors\';\nimport { Cashfree } from \'cashfree-pg\';\nimport path from \'path\';\nimport { fileURLToPath } from \'url\';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nconst app = express();\n\napp.use(cors());\napp.use(express.json());\napp.use(express.static(path.join(__dirname, \'..\/dist\')));\n\nCashfree.XClientId = process.env.CASHFREE_CLIENT_ID;\nCashfree.XClientSecret = process.env.CASHFREE_CLIENT_SECRET;\nCashfree.XEnvironment = Cashfree.Environment.PRODUCTION;\n\napp.post(\'/api/payment/cashfree/initiate\', async (req, res) => {\n    try {\n        const { order_amount, order_id, order_currency, customer_details } = req.body;\n\n        const request = {\n            order_amount,\n            order_currency,\n            order_id,\n            customer_details,\n            order_meta: {\n                // Return url is where cashfree will redirect the user after payment\n                // This should be a url on your frontend application\n                return_url: \'https://flipkart3-wq38.onrender.com/order/success?order_id={order_id}\',\n            }\n        };\n\n        const cashfree = new Cashfree({\n            TENV: Cashfree.TENV.PRODUCTION,\n            clientId: process.env.CASHFREE_CLIENT_ID,\n            clientSecret: process.env.CASHFREE_CLIENT_SECRET,\n        });\n\n        const response = await cashfree.orders.create(request);\n        res.json(response);\n    } catch (error) {\n        console.error(\"Cashfree Error\", error);\n        res.status(500).json({ success: false, message: \"Payment initiation failed\" });\n    }\n});\n\napp.get(\'*', (req, res) => {\n  res.sendFile(path.join(__dirname, \'..\/dist\', \'index.html\'));\n});\n\nconst PORT = process.env.PORT || 5000;\napp.listen(PORT, () => console.log(`Server running on port ${PORT}`));\n